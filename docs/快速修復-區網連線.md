# 快速修復：iPad 無法連線到 192.168.50.72:5173

## ✅ 已完成的修復

我已經修改了 `compose.yaml`，明確將端口綁定到所有網路介面（`0.0.0.0`）。

## 🔧 請執行以下步驟

### 步驟 1：重啟 Docker 容器

```bash
# 停止現有容器
docker compose down

# 重新啟動容器
docker compose up -d --build
```

### 步驟 2：檢查容器狀態

```bash
docker ps
```

**確認** `PORTS` 欄位顯示：
```
0.0.0.0:5173->5173/tcp
```

如果顯示 `127.0.0.1:5173->5173/tcp`，請重新執行步驟 1。

### 步驟 3：檢查容器日誌

```bash
docker logs sen-ba-li-18-dev
```

**確認**看到類似以下輸出：
```
VITE v7.x.x  ready in xxx ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: http://172.x.x.x:5173/
```

### 步驟 4：設定 Windows 防火牆（重要！）

這是**最常見的問題**。請執行以下命令（需要管理員權限）：

#### 方法一：使用命令列（推薦）

1. 以**管理員身份**開啟命令提示字元（CMD）或 PowerShell
2. 執行：
   ```cmd
   netsh advfirewall firewall add rule name="Docker Vite Dev Server" dir=in action=allow protocol=TCP localport=5173
   ```

#### 方法二：使用圖形介面

1. 開啟「Windows 安全性」→「防火牆與網路保護」
2. 點選「進階設定」
3. 點選「輸入規則」→「新增規則」
4. 選擇「連接埠」→「下一步」
5. 選擇「TCP」，輸入「特定本機連接埠」：`5173`
6. 選擇「允許連線」→「下一步」
7. 勾選所有設定檔（網域、私人、公用）→「下一步」
8. 輸入名稱：「Docker Vite Dev Server」→「完成」

### 步驟 5：驗證本機連線

在電腦上開啟瀏覽器，訪問：
```
http://localhost:5173
```

如果本機無法訪問，請檢查容器日誌（步驟 3）。

### 步驟 6：從 iPad 測試

在 iPad 上開啟瀏覽器，訪問：
```
http://192.168.50.72:5173
```

## 🔍 如果仍然無法連線

### 檢查 1：確認 iPad 和電腦在同一網路

- 檢查 iPad 的 Wi-Fi 設定
- 確認連接到相同的 Wi-Fi 網路
- 確認 iPad 的 IP 地址也在 `192.168.50.x` 網段

### 檢查 2：測試網路連線

在 iPad 上（如果有終端機應用）：
```bash
ping 192.168.50.72
```

如果 ping 不通，可能是網路問題，不是 Docker 問題。

### 檢查 3：臨時關閉防火牆測試（僅用於診斷）

⚠️ **警告**：僅用於診斷，測試完畢後請重新開啟。

1. 以管理員身份開啟命令提示字元
2. 執行：
   ```cmd
   netsh advfirewall set allprofiles state off
   ```
3. 從 iPad 測試連線
4. 測試完畢後，重新開啟防火牆：
   ```cmd
   netsh advfirewall set allprofiles state on
   ```

如果關閉防火牆後可以連線，問題就是防火牆設定。

### 檢查 4：檢查 Docker Desktop 設定

1. 開啟 Docker Desktop
2. 進入「Settings」→「Resources」→「Network」
3. 確認網路設定正確
4. 嘗試重啟 Docker Desktop

### 檢查 5：檢查端口占用

```cmd
netstat -ano | findstr :5173
```

如果端口被其他程式占用，需要：
- 關閉占用端口的程式，或
- 修改 `compose.yaml` 使用其他端口（如 5174）

## 📋 完整診斷命令

如果以上步驟都無法解決，請執行以下命令並提供輸出：

```bash
# 1. 容器狀態
docker ps

# 2. 容器日誌（最後 50 行）
docker logs --tail 50 sen-ba-li-18-dev

# 3. 端口映射
docker port sen-ba-li-18-dev

# 4. 容器網路資訊
docker inspect sen-ba-li-18-dev | findstr "IPAddress"

# 5. 本機端口監聽狀態
netstat -ano | findstr :5173
```

## 🎯 最可能的解決方案

根據經驗，**90% 的問題是防火牆阻擋**。請務必執行**步驟 4**設定防火牆規則。

如果設定防火牆後仍然無法連線，請提供上述診斷命令的輸出，我可以進一步協助。
